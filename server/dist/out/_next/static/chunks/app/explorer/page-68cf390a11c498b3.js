(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{82220:function(e,t,l){Promise.resolve().then(l.bind(l,13124))},56254:function(e,t,l){"use strict";var n=l(57437);l(2265),t.Z=e=>{let{title:t}=e;return(0,n.jsx)("h2",{className:"text-gray-400 pl-2 py-1 font-bold text-xs border-gray-400 border",children:t})}},23242:function(e,t,l){"use strict";l.d(t,{Z:function(){return i}});var n=l(57437),a=l(2265);let r=e=>{let{mode:t="none"}=e;return(0,n.jsx)("svg",{"aria-hidden":"true",role:"img",className:"octicon octicon-filter",viewBox:"0 0 16 16",width:"10",height:"10",fill:"currentColor",style:{transform:"rotate(".concat("desc"===t?"0":"180","deg)")},children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M.75 3a.75.75 0 000 1.5h14.5a.75.75 0 000-1.5H.75zM3 7.75A.75.75 0 013.75 7h8.5a.75.75 0 010 1.5h-8.5A.75.75 0 013 7.75zm3 4a.75.75 0 01.75-.75h2.5a.75.75 0 010 1.5h-2.5a.75.75 0 01-.75-.75z"})})};r.defaultProps={mode:"none"};var s=l(95576),o=a.memo(e=>{let t,l,{value:a}=e;return a instanceof Date?t=new Date(a).toLocaleString():"object"==typeof a?(l=JSON.stringify(a,null,2),t=JSON.stringify(a)):(t=a,"string"==typeof a&&(null==a?void 0:a.length)>20&&(l=a)),(0,n.jsxs)("td",{className:"border-l border-b border-gray-600 px-2 break-all truncate text-white",style:{maxWidth:100},children:[(0,n.jsx)("span",{"data-tip":!0,"data-for":"btn-run-".concat(a),children:null!=t?t:""}),l&&(0,n.jsx)(s.Z,{id:"btn-run-".concat(a),type:"dark",children:(0,n.jsx)("pre",{className:"font-mono",style:{height:"40%"},children:l})})]})});let c=e=>{let{columnNames:t=[],tableData:l=[],selectedSchema:a="",selectedTable:s="",onSort:c=console.warn}=e,i=e=>{let l;let n=t[e];l=(null==n?void 0:n.sort)?(null==n?void 0:n.sort)==="asc"?"desc":"none":"asc",c({[null==n?void 0:n.column_name]:l})};return(0,n.jsx)("div",{className:"",children:(0,n.jsxs)("table",{className:"border border-gray-600 h-full w-full table-fixed overflow-x-scroll",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{className:"bg-gray-900",children:null==t?void 0:t.map((e,t)=>{let{visible:l=!0,column_name:a="",sort:s}=e;return l&&(0,n.jsxs)("th",{className:"border bg-gray-900 border-gray-600 ".concat(a," ").concat(!s&&"text-transparent"," hover:text-gray-200 cursor-pointer"),style:{minWidth:200,width:200,position:"sticky",top:0,zIndex:10},onClick:()=>i(t),children:[(0,n.jsx)("div",{className:"relative p-1 ".concat(s?"text-blue-600":""),children:(0,n.jsx)(r,{mode:s})}),(0,n.jsx)("div",{className:"w-full p-3 px-4 text-gray-200",children:a})]},a)})})}),(0,n.jsx)("tbody",{children:null==l?void 0:l.map((e,l)=>{var r;return(0,n.jsx)("tr",{className:"hover:bg-gray-700 hover:text-gray-100",children:null==t?void 0:t.map(t=>{let{visible:l=!0,column_name:r}=t,c=null==e?void 0:e[r];return l&&(0,n.jsx)(o,{value:c},"".concat(a,"_").concat(s,"_").concat(r,"_").concat("object"==typeof c?JSON.stringify(c):c))})},null!==(r=null==e?void 0:e.id)&&void 0!==r?r:"col_".concat(l))})})]})})};c.defaultProps={tableData:[]};var i=c},13124:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return g}});var n=l(57437),a=l(16463),r=l(96681),s=l(2265);let o=e=>{let{schemas:t=[],selectedSchema:l="",setSelectedSchema:a}=e;return(0,n.jsxs)("div",{className:"relative inline-block w-full text-gray-700",children:[(0,n.jsx)("select",{className:"appearance-none bg-gray-900 border focus:shadow-outline p-2 placeholder-gray-600 text-gray-200 text-xs w-full",placeholder:"Regular input",value:l,onChange:e=>a(e.target.value),children:t.map(e=>(0,n.jsx)("option",{children:e},e))}),(0,n.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,n.jsx)("svg",{className:"w-4 h-4 fill-current",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd",fillRule:"evenodd"})})})]})};o.defaultProps={selectedSchema:"false"};let c=(e,t)=>null!=t&&!!t.find(t=>t.table_name===e);var i=e=>{let{tables:t,selectedTable:l,setSelectedTable:a}=e;return(0,s.useEffect)(()=>{l&&c(null==l?void 0:l.table_name,t)||a(null==t?void 0:t[0])},[l,a,t]),(0,n.jsxs)("div",{className:"autoscroll h-full max-h-full flex flex-col text-gray-200 text-xs",style:{minWidth:250},onKeyDown:e=>{"ArrowUp"===e.key?(null==l?void 0:l.index)&&(null==l?void 0:l.index)>=0&&a(t[(null==l?void 0:l.index)-1]):"ArrowDown"===e.key&&(null==l?void 0:l.index)!==void 0&&(null==t?void 0:t.length)&&(null==l?void 0:l.index)<(null==t?void 0:t.length)&&a(t[(null==l?void 0:l.index)+1])},children:[null==t?void 0:t.map(e=>(0,n.jsx)("button",{className:"pl-4 pr-4 text-left hover:bg-gray-600 hover:text-gray-200 cursor-pointer ".concat((null==l?void 0:l.table_name)===(null==e?void 0:e.table_name)&&"hover:bg-gray-600 bg-gray-600"),onClick:()=>a(e),type:"button","data-ph-no-capture":!0,children:null==e?void 0:e.table_name},null==e?void 0:e.table_name)),!(null==t?void 0:t.length)&&(0,n.jsx)("span",{className:"w-full text-center p-2",children:"No tables found"})]})},u=l(95576),d=l(23242);let h=[10,50,100,1e3];var m=s.memo(e=>{var t,l;let{session:a,selectedSchema:r,selectedTable:o}=e,[c,i]=(0,s.useState)({currentPage:1,currentPageSize:h[1]}),[m,v]=(0,s.useState)({}),x=()=>{"".concat(r,"_").concat(o,"_P-").concat(f,"_").concat(g,"-items_").concat(new Date().toISOString())};if((0,s.useEffect)(()=>{(async()=>{let e,t;if(r&&o){t=await a.getColumnNames({schema:r,table:o});let{currentPage:n,currentPageSize:s}=c;if(e=await a.getTableData({schema:r,table:o,offset:0,pagenumber:n,size:s,sortedColumns:null==c?void 0:c.sortedColumns}),(null==t?void 0:t.status)==="SUCCESS"&&(null==e?void 0:e.status)==="SUCCESS"){var l;v({tableData:null==e?void 0:e.rows,columnNames:null==t?void 0:null===(l=t.rows)||void 0===l?void 0:l.map(e=>{var t;return{...e,sort:null==c?void 0:null===(t=c.sortedColumns)||void 0===t?void 0:t[null==e?void 0:e.column_name]}})})}}})()},[r,o,a,c]),!o)return(0,n.jsx)("div",{className:"w-full h-full max-h-full max-w-full bg-gray-800 border-l border-gray-600 text-gray-400 text-sm overflow-auto overflow-x-scroll height-adjust-25 flex justify-items-center items-center",children:(0,n.jsx)("span",{className:"h-full w-full text-center m-auto p-6",children:"Please select a table from the sidebar"})});let{currentPage:f,currentPageSize:g}=c,b=e=>i(t=>({...t,currentPage:e})),p=e=>i({currentPage:1,currentPageSize:e});return(0,n.jsxs)("div",{className:"w-full h-full max-h-full max-w-full bg-gray-800 border-l border-gray-600 text-gray-400 text-sm overflow-auto overflow-x-scroll height-adjust-25",children:[(0,n.jsxs)("div",{className:"w-full bg-gray-800 flex border border-gray-700 header-fixed",children:[(0,n.jsxs)("div",{className:"w-full bg-gray-800 flex my-auto px-4 text-base font-normal truncate",style:{height:25},children:[null!=r?r:""," / ",null!=o?o:"",(0,n.jsx)("button",{type:"button",className:"h-full pl-4 pr-4 text-gray-100",onClick:()=>x(),"data-tip":!0,"data-for":"btn-export",children:"⬇️"}),(0,n.jsx)(u.Z,{id:"btn-export",type:"dark",place:"right",children:(0,n.jsx)("span",{children:"Export Current Page"})})]}),(0,n.jsxs)("div",{className:"w-auto items-center flex justify-end rounded-md my-2",style:{height:25},children:[(0,n.jsx)("button",{type:"button",className:"h-full pl-4 pr-4 text-gray-100",onClick:()=>b(f>1?Number(f)-1:1),children:"<"}),(0,n.jsx)("input",{type:"number",min:1,className:"h-full px-2 text-gray-100 bg-transparent focus:outline-none border-b-2 font-bold",style:{width:25+5*"".concat(f).length},value:f,onChange:e=>e.target.value&&b(Number(e.target.value))}),(0,n.jsx)("button",{type:"button",className:"h-full pl-4 pr-4 text-gray-100",onClick:()=>b(Number(f)+1),children:">"}),(0,n.jsx)("select",{className:"pl-4 mr-2 bg-transparent focus:shadow-outline px-4",onChange:e=>p(Number.parseInt(e.target.value,10)),value:g,children:h.map(e=>(0,n.jsxs)("option",{value:e,children:[e," rows/page"]},e))})]})]}),(0,n.jsx)("div",{className:"table-wrapper",style:{overflow:"auto",minHeight:"100%",height:"calc(100vh - 25px)",width:"calc(100vw - 300px)"},children:(0,n.jsx)(d.Z,{columnNames:null!==(t=null==m?void 0:m.columnNames)&&void 0!==t?t:[],tableData:null!==(l=null==m?void 0:m.tableData)&&void 0!==l?l:[],selectedSchema:null!=r?r:"",selectedTable:null!=o?o:"",onSort:e=>{i(t=>{var l;let n={};return Object.entries({...null!==(l=null==t?void 0:t.sortedColumns)&&void 0!==l?l:{},...e}).forEach(e=>{let[t,l]=e;("asc"===l||"desc"===l)&&(n={...n,[t]:l})}),{...t,sortedColumns:n}})}})})]})}),v=l(56254),x=e=>{let{session:t}=e,[l,a]=(0,s.useState)([]),[r,c]=(0,s.useState)(),[u,d]=(0,s.useState)([]),[h,x]=(0,s.useState)({});return(0,s.useEffect)(()=>{null==t||t.getDBSchemas().then(e=>((null==e?void 0:e[0])&&c(e[0]),a(e))).catch(console.error)},[]),(0,s.useEffect)(()=>{r&&t.getAllTables(r).then(e=>d(null==e?void 0:e.map((e,t)=>({...e,index:t})))).catch(console.error)},[r,t]),(0,n.jsxs)("div",{className:"flex w-full h-full",children:[(0,n.jsx)("div",{className:"h-full bg-gray-800",style:{width:300},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{title:"SCHEMAS"}),(0,n.jsx)(o,{schemas:l,selectedSchema:r,setSelectedSchema:c}),(0,n.jsx)(v.Z,{title:"TABLES"}),u&&(0,n.jsx)(i,{tables:u,selectedTable:h,setSelectedTable:x})]})}),(0,n.jsx)("div",{className:"h-full w-full max-h-full",children:(0,n.jsx)(m,{session:t,key:"".concat(r,"_").concat(null==h?void 0:h.table_name),selectedTable:null==h?void 0:h.table_name,selectedSchema:r})})]})},f=l(29361);function g(){let e=(0,a.usePathname)(),t="SQL";(null==e?void 0:e.includes("/sql"))?t="SQL":(null==e?void 0:e.includes("/overview"))?t="OVERVIEW":(null==e?void 0:e.includes("/overview"))&&(t="OVERVIEW");let l=new f.Z("PG");return(0,n.jsx)("main",{className:"flex flex-col-screen w-full bg-gray-800",children:(0,n.jsx)(r.wI,{children:(0,n.jsx)(x,{session:l,selectedTab:t})})})}},29361:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});let n=async(e,t)=>{let l=await fetch("http://localhost:3253/api/execute_pg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({queries:e})});if(!l.ok)throw Error("Failed to execute query");return await l.json()};class a{constructor(e){this.executeSQL=e=>new Promise((t,l)=>{n([e],this.id).then(e=>{var n,a;(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n[0])?t(null==e?void 0:null===(a=e.data)||void 0===a?void 0:a[0]):l(Error("Failed to execute query"))}).catch(l)}),this.getDBSchemas=()=>new Promise((e,t)=>{this.executeSQL("SELECT schema_name\n      FROM information_schema.schemata\n      WHERE \"schema_name\" NOT LIKE 'pg_%' AND schema_name <> 'information_schema';").then(l=>(null==l?void 0:l.rows)&&Array.isArray(null==l?void 0:l.rows)?e(null==l?void 0:l.rows.filter(e=>!!(null==e?void 0:e.schema_name)).map(e=>e.schema_name)):t(Error("Failed to parse the schemas"))).catch(t)}),this.getErdData=()=>new Promise((e,t)=>{this.executeSQL("SELECT\n      tc.table_schema,\n      tc.constraint_name,\n      tc.table_name,\n      kcu.column_name,\n      ccu.table_schema AS foreign_table_schema,\n      ccu.table_name AS foreign_table_name,\n      ccu.column_name AS foreign_column_name\n  FROM\n      information_schema.table_constraints AS tc\n      JOIN information_schema.key_column_usage AS kcu\n        ON tc.constraint_name = kcu.constraint_name\n        AND tc.table_schema = kcu.table_schema\n      JOIN information_schema.constraint_column_usage AS ccu\n        ON ccu.constraint_name = tc.constraint_name\n        AND ccu.table_schema = tc.table_schema;\n  ").then(t=>(console.log(t),e(t))).catch(t)}),this.getAllTables=e=>new Promise((t,l)=>{this.executeSQL("SELECT * FROM information_schema.tables\n      WHERE table_schema = '".concat(e,"'")).then(e=>(null==e?void 0:e.rows)&&Array.isArray(null==e?void 0:e.rows)?t(null==e?void 0:e.rows.filter(e=>!!(null==e?void 0:e.table_name))):l(Error("Failed to parse the schemas"))).catch(l)}),this.getTableData=e=>{let{schema:t,table:l,pagenumber:n=1,size:a=50,sortedColumns:r}=e;return new Promise((e,s)=>{let o='SELECT * FROM "'.concat(t,'"."').concat(l,'" ');r&&(o+=" ORDER BY "+Object.entries(r).map(e=>{let[t,l]=e;return"".concat(t," ").concat(l)}).join(",")),o+=" LIMIT ".concat(a," OFFSET ").concat((n-1)*a,";"),this.executeSQL(o).then(t=>e(t)).catch(s)})},this.getColumnNames=e=>{let{schema:t,table:l}=e;return new Promise((e,n)=>{let a="SELECT\n      column_name,\n      data_type\n    FROM\n      INFORMATION_SCHEMA.COLUMNS\n    WHERE\n      TABLE_NAME = '".concat(l,"'\n      AND table_schema = '").concat(t,"';");this.executeSQL(a).then(t=>e(t)).catch(n)})},this.id=e}}var r=a},96681:function(e,t,l){"use strict";l.d(t,{wI:function(){return i},mr:function(){return o}});var n=l(57437),a=l(2265);function r(){var e,t;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{history:[]},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_SESSION":return{...l,session:n.payload};case"CLEAR_SESSION":return{...l,session:void 0};case"SET_HISTORY":return{...l,history:n.payload};case"ADD_HISTORY":{let t=null!==(e=l.history)&&void 0!==e?e:[],a=t.findIndex(e=>e.sql===n.payload.sql);if(-1===a)return{...l,history:[n.payload,...t]};{let e=t.map((e,t)=>t===a?{...e,time:new Date}:e);return{...l,history:e}}}case"REMOVE_HISTORY":let a=[...null!==(t=l.history)&&void 0!==t?t:[]];return null==a||a.splice(n.payload,1),{...l,history:a};case"CLEAR_HISTORY":return{...l,history:[]};default:return l}}let s=(0,a.createContext)({});function o(){return(0,a.useContext)(s)}let c=()=>{try{var e;return JSON.parse(null!==(e=localStorage.getItem("SQL_HISTORY"))&&void 0!==e?e:"[]")}catch(e){return[]}},i=e=>{let{children:t}=e,{Provider:l}=s,o=c();return(0,n.jsx)(l,{value:(0,a.useReducer)(r,{history:null!=o?o:[]}),children:t})}}},function(e){e.O(0,[756,971,23,744],function(){return e(e.s=82220)}),_N_E=e.O()}]);